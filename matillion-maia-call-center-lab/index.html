
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Matillion Maia: Call Center AI Agents</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/claat-public/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid="UA-XXXXXXXXX-X"
                  id="matillion-maia-call-center-lab"
                  title="Matillion Maia: Call Center AI Agents"
                  environment="web"
                  feedback-link="https://github.com/datalab-solutions/matillion-codelabs/issues">
    
      <google-codelab-step label="Overview" duration="1">
        <h2 is-upgraded>Introduction</h2>
<p>In this quickstart, you&#39;ll sign up for Matillion&#39;s Data Productivity Cloud and prepare your environment for call center analytics with Maia. You&#39;ll create an account, choose your region and experience, and (optionally) connect a Snowflake trial warehouse so you can start building pipelines in minutes.</p>
<p>This hands-on lab demonstrates how to use <strong>Matillion Maia</strong> to transform call center data from raw audio transcripts using Snowflake Cortex AI functions. You&#39;ll learn to ingest, transcribe, enrich, and structure audio recordings (<code>.wav</code>, <code>.mp3</code>) and transcript documents (<code>.txt</code>, <code>.pdf</code>) directly in Snowflake. With functions like <code>AI_TRANSCRIBE</code>, <code>SUMMARIZE</code>, <code>SENTIMENT</code>, <code>AI_SENTIMENT</code>, <code>AI_CLASSIFY</code>, <code>AI_COMPLETE</code>, and <code>EXTRACT_ANSWER</code>, you&#39;ll unlock actionable insights from unstructured conversations and build advanced analytics pipelines.</p>
<ul>
<li>Convert call recordings into searchable transcripts.</li>
<li>Summarize long conversations into concise overviews.</li>
<li>Measure overall and entity-specific sentiment.</li>
<li>Classify call types by intent (complaint, query, sales, cancellation, etc.).</li>
<li>Extract key answers like customer name, call reason, or resolution.</li>
<li>Generate structured insights, action items, and follow-ups using completions.</li>
</ul>
<p>In addition, you will:</p>
<ul>
<li>Deploy a <strong>Cortex Search Service</strong> to perform contextual, vector-based retrieval across transcripts.</li>
<li>Use <strong>Cortex Analyst</strong> to enable guided, natural language Q&amp;A on call data.</li>
</ul>
<p>By the end of this lab, you will have transformed <strong>raw call recordings</strong> into <strong>actionable business intelligence</strong>, equipping analysts and support managers with the ability to identify trends, improve service quality, and uncover insights faster.</p>
<h2 class="checklist" is-upgraded>What You&#39;ll Learn</h2>
<h3 is-upgraded>Maia</h3>
<ul>
<li>Understand the capabilities of Matillion Maia for AI-powered data transformation.</li>
<li>Learn how Maia integrates with Snowflake to process unstructured call center data.</li>
<li>Explore Maia&#39;s features for orchestrating ETL workflows and leveraging AI functions.</li>
<li>Discover how Maia simplifies building, scheduling, and monitoring data pipelines.</li>
</ul>
<h3 is-upgraded>AI SQL</h3>
<ul>
<li>Upload and manage unstructured call center data in Snowflake</li>
<li>Transcribe audio with <a href="https://docs.snowflake.com/en/sql-reference/functions/ai_transcribe" target="_blank"><code>AI_TRANSCRIBE</code></a></li>
<li>Summarize transcripts with <a href="https://docs.snowflake.com/en/sql-reference/functions/summarize-snowflake-cortex" target="_blank"><code>SUMMARIZE</code></a></li>
<li>Analyze sentiment using <a href="https://docs.snowflake.com/en/sql-reference/functions/sentiment-snowflake-cortex" target="_blank"><code>SENTIMENT</code></a> and <a href="https://docs.snowflake.com/en/sql-reference/functions/ai_sentiment" target="_blank"><code>AI_SENTIMENT</code></a></li>
<li>Classify call intent with <a href="https://docs.snowflake.com/en/sql-reference/functions/ai_classify" target="_blank"><code>AI_CLASSIFY</code></a></li>
<li>Extract structured details with <a href="https://docs.snowflake.com/en/sql-reference/functions/extract_answer-snowflake-cortex" target="_blank"><code>EXTRACT_ANSWER</code></a></li>
<li>Perform advanced completions with <a href="https://docs.snowflake.com/en/sql-reference/functions/ai_complete" target="_blank"><code>AI_COMPLETE</code></a></li>
<li>Explore prompt building with <a href="https://docs.snowflake.com/en/sql-reference/functions/prompt" target="_blank"><code>PROMPT</code></a> to simplify and structure code</li>
<li>Aggregate textual data and generate concise summaries with <a href="https://docs.snowflake.com/en/sql-reference/functions/ai_agg" target="_blank"><code>AI_AGG</code></a></li>
</ul>
<h2 is-upgraded>Download Source Files</h2>
<p>Download all source SQL files for this lab <a href="https://download-directory.github.io/?url=https%3A%2F%2Fgithub.com%2Fdatalabsolutions%2FAI-Labs%2Ftree%2Fmain%2Fsnowflake-snowflake-intelligence-callcenter-lab%2Fscripts" target="_blank">here</a></p>
<h2 is-upgraded>Prerequisites</h2>
<ul>
<li>A <a href="https://trial.snowflake.com/?owner=SPN-PID-452710" target="_blank">Snowflake account</a> in a region where <strong>Snowflake Cortex LLM functions</strong> are supported</li>
<li>Basic familiarity with SQL and the Snowflake UI</li>
<li>Access all the scripts for this Lab <a href="https://github.com/datalabsolutions/AI-Labs/tree/main/snowflake-snowflake-intelligence-callcenter-lab" target="_blank">on GitHub</a></li>
<li><a href="https://github.com/datalabsolutions/AI-Labs/blob/a27daf7c5d6f72949cc73c820351348d755bbd9c/snowflake-snowflake-intelligence-callcenter-lab/assets/audio_files/audio-files.zip?raw=1" target="_blank">Download all the audio files</a></li>
</ul>
<p>ðŸ’¡ <strong>Tip:</strong> Explore this interactive walkthrough to learn how to sign up for a <a href="https://app.supademo.com/demo/cmbw9nmxe0606xw0izxyku479" target="_blank">Snowflake account</a>.</p>
<p>ðŸ’¡ <strong>Tip:</strong> Use the <a href="https://docs.snowflake.com/en/user-guide/snowflake-cortex/llm-functions#availability" target="_blank">LLM Function Availability</a> page to check which cloud regions are supported.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Configure Snowflake" duration="4">
        <h2 is-upgraded>Learning Outcome</h2>
<p>Create the core Snowflake resources needed to run the AI Lab. This includes a database, warehouse, schemas, and a stage for uploading audio and transcript files.</p>
<h2 is-upgraded>Download Script</h2>
<p>Download the source code for this step <a href="https://github.com/datalabsolutions/AI-Labs/blob/main/snowflake-snowflake-intelligence-callcenter-lab/scripts/01-AI-LAB-CONFIGURATION.sql" target="_blank">here</a>.</p>
<h2 is-upgraded>Description</h2>
<p>This setup script prepares your Snowflake environment to ingest and process unstructured call center data.</p>
<ul>
<li><code>CREATE DATABASE</code> ensures your lab operates in a clean, isolated environment.</li>
<li><code>CREATE WAREHOUSE</code> provisions compute resources for your queries and is configured to minimize cost via automatic suspend/resume.</li>
<li><code>CREATE SCHEMA</code> creates logical namespaces for raw files (<code>RAW</code>), processed/intermediate data (<code>STAGE</code>), and consolidated analytics objects (<code>ANALYTICS</code>).</li>
<li><code>CREATE STAGE</code> sets up a secure location to upload audio and transcript documents (<code>.mp3</code>, <code>.wav</code>, <code>.pdf</code>, <code>.txt</code>), supports directory-style access, and uses Snowflakeâ€‘managed encryption.</li>
</ul>
<h2 is-upgraded>Step 1: Create the Database</h2>
<p>This command creates a database named <code>CALL_CENTER_DB</code> if it doesn&#39;t already exist. Using <code>IF NOT EXISTS</code> ensures the script is idempotent and safe to rerun.</p>
<pre><code language="language-sql" class="language-sql">CREATE DATABASE IF NOT EXISTS CALL_CENTER_DB;
</code></pre>
<h2 is-upgraded>Step 2: Create a Compute Warehouse</h2>
<p>This step provisions a warehouse named <code>USER_STD_XSMALL_WH</code> with costâ€‘efficient settings:</p>
<ul>
<li>Size: <code>XSMALL</code> â€” small and costâ€‘effective for light workloads.</li>
<li>Type: <code>STANDARD</code> â€” supports most use cases.</li>
<li>Auto Suspend: <code>60</code> seconds â€” saves credits after inactivity.</li>
<li>Auto Resume: <code>TRUE</code> â€” resumes automatically on query.</li>
<li>Initially Suspended: <code>TRUE</code> â€” starts paused until needed.</li>
</ul>
<pre><code language="language-sql" class="language-sql">CREATE OR REPLACE WAREHOUSE USER_STD_XSMALL_WH
WITH
    WAREHOUSE_SIZE = &#39;XSMALL&#39;
    WAREHOUSE_TYPE = &#39;STANDARD&#39;
    AUTO_SUSPEND = 60
    AUTO_RESUME = TRUE
    INITIALLY_SUSPENDED = TRUE;

CREATE OR REPLACE WAREHOUSE APP_STD_XSMALL_WH
WITH
    WAREHOUSE_SIZE = &#39;XSMALL&#39;
    WAREHOUSE_TYPE = &#39;STANDARD&#39;
    AUTO_SUSPEND = 60
    AUTO_RESUME = TRUE
    INITIALLY_SUSPENDED = TRUE;
</code></pre>
<p>ðŸ’¡ <strong>Tip:</strong> Auto-suspend after 60 seconds prevents unnecessary credit usage. Auto-resume ensures queries always run when needed.</p>
<h2 is-upgraded>Step 3: Create Required Schemas</h2>
<p>Schemas help organize your database objects.</p>
<pre><code language="language-sql" class="language-sql">CREATE SCHEMA IF NOT EXISTS CALL_CENTER_DB.RAW;
CREATE SCHEMA IF NOT EXISTS CALL_CENTER_DB.STAGE;
CREATE SCHEMA IF NOT EXISTS CALL_CENTER_DB.ANALYTICS;
</code></pre>
<ul>
<li><code>RAW</code> stores the ingested audio and transcript files.</li>
<li><code>STAGE</code> is used for parsed, structured, or AI-enriched data.</li>
<li><code>ANALYTICS</code> is reserved for semantic views, aggregated results, and reporting tables.</li>
</ul>
<p>Using <code>IF NOT EXISTS</code> prevents duplication errors and makes the script safe to rerun.</p>
<h2 is-upgraded>Step 4: Create an Internal Stage for Uploads</h2>
<p>The internal stage is where you will upload audio files.</p>
<pre><code language="language-sql" class="language-sql">CREATE OR REPLACE STAGE CALL_CENTER_DB.RAW.INT_STAGE_DOC_RAW
    DIRECTORY = ( ENABLE = true )
    ENCRYPTION = ( TYPE = &#39;SNOWFLAKE_SSE&#39; );
</code></pre>
<p>ðŸ”’ <strong>Note:</strong> Files uploaded here are secured with Snowflake&#39;s Server-Side Encryption (SSE).</p>
<h2 is-upgraded>Step 4: Create Matillion User and Role</h2>
<p>The internal stage is where you will upload audio files.</p>
<pre><code language="language-sql" class="language-sql">CREATE ROLE IF NOT EXISTS APP_MATILLION_ROLE;

-- Assign application role to SYSADMIN (best practice)
GRANT ROLE APP_MATILLION_ROLE TO ROLE SYSADMIN;

-- Create user
CREATE USER IF NOT EXISTS APP_MATILLION_SVC
  TYPE = LEGACY_SERVICE                           -- Explicitly mark as service account
  PASSWORD = &#39;M@tillion!1.&#39;
  DEFAULT_ROLE = APP_MATILLION_ROLE
  DEFAULT_WAREHOUSE = APP_STD_XSMALL_WH
  MUST_CHANGE_PASSWORD = FALSE             -- Not required for service users
  COMMENT = &#39;Service account for Matillion ETL operations&#39;;

-- Assign role to user
GRANT ROLE APP_MATILLION_ROLE TO USER APP_MATILLION_SVC;

-- Database &amp; schema usage
GRANT USAGE ON DATABASE CALL_CENTER_DB TO ROLE APP_MATILLION_ROLE;
GRANT USAGE ON ALL SCHEMAS IN DATABASE CALL_CENTER_DB TO ROLE APP_MATILLION_ROLE;

-- Warehouse usage
GRANT USAGE ON WAREHOUSE APP_STD_XSMALL_WH TO ROLE APP_MATILLION_ROLE;

-- Stage usage
GRANT READ ON STAGE CALL_CENTER_DB.RAW.INT_STAGE_DOC_RAW TO ROLE APP_MATILLION_ROLE;
GRANT WRITE ON STAGE CALL_CENTER_DB.RAW.INT_STAGE_DOC_RAW TO ROLE APP_MATILLION_ROLE;

-- Table privileges (all current + future tables)
GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA CALL_CENTER_DB.RAW TO ROLE APP_MATILLION_ROLE;
GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA CALL_CENTER_DB.STAGE TO ROLE APP_MATILLION_ROLE;
GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA CALL_CENTER_DB.ANALYTICS TO ROLE APP_MATILLION_ROLE;

GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA CALL_CENTER_DB.RAW TO ROLE APP_MATILLION_ROLE;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA CALL_CENTER_DB.STAGE TO ROLE APP_MATILLION_ROLE;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA CALL_CENTER_DB.ANALYTICS TO ROLE APP_MATILLION_ROLE;


</code></pre>
<h2 is-upgraded>Step 6: Upload Files to the Stage</h2>
<p>Your internal stage <code>CALL_CENTER_DB.RAW.INT_STAGE_DOC_RAW</code> is now set up.</p>
<ol type="1">
<li>In Snowsight, go to <strong>Databases</strong>.</li>
<li>Select <code>CALL_CENTER_DB</code> â†’ <code>RAW</code> â†’ <strong>Stages</strong>.</li>
<li>Click on <code>INT_STAGE_DOC_RAW</code>.</li>
<li>Click <strong>+ Files</strong> and upload one or more audio recordings (MP3/WAV).</li>
</ol>
<p>ðŸ”’ <strong>Note:</strong> The zip file that you <a href="https://github.com/datalabsolutions/AI-Labs/blob/a27daf7c5d6f72949cc73c820351348d755bbd9c/snowflake-snowflake-intelligence-callcenter-lab/assets/audio_files/audio-files.zip?raw=1" target="_blank">downloaded</a> will need to be unzipped.  You need to upload the individual files.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Configure Matillion" duration="0">
        <h2 is-upgraded>Learning Outcomes</h2>
<p>In this section, you will learn how to sign up for Matillion&#39;s Data Productivity Cloud and connect Matillion to your Snowflake warehouse. You will also set up the necessary defaults for seamless data integration.</p>
<h2 is-upgraded>Prerequisites</h2>
<p>Before you begin, ensure you have:</p>
<ul>
<li>Access to a Snowflake account with privileges to create databases, warehouses, schemas, and stages. ()</li>
</ul>
<h2 is-upgraded>Description</h2>
<p>In this section, you&#39;ll create a Matillion account and configure your environment to work with call center data. You&#39;ll learn how to register, set up your profile, select your region, choose your experience, and connect to your Snowflake warehouse.</p>
<p>The trial is free and includes 500 usage credits, allowing you to explore Matillion&#39;s features for building and managing ETL pipelines.</p>
<h2 is-upgraded>Step 1: Create your account</h2>
<ul>
<li>Go to <a href="https://hub.matillion.com/register" target="_blank">hub.matillion.com/register</a></li>
<li>Choose a password and verify your email address</li>
</ul>
<p class="image-container"><img alt="Matillion sign up - Create account" src="img\\97b4c6f5a22ec7d.png"></p>
<p class="image-container"><img alt="Matillion sign up - Create account" src="img\\4f7cc539552e383a.gif"></p>
<h2 is-upgraded>Step 2: Create your profile</h2>
<ul>
<li>Enter basic details like name, job title, and contact information</li>
</ul>
<p class="image-container"><img alt="Matillion sign up - Create profile" src="img\\18d03b3c0438c92f.png"></p>
<h2 is-upgraded>Step 3: Set up your account (Region)</h2>
<ul>
<li>Select your preferred region. Note: this cannot be changed later</li>
</ul>
<p class="image-container"><img alt="Matillion sign up - Select region" src="img\\7200123f2506027c.png"></p>
<h2 is-upgraded>Step 4: Choose your experience</h2>
<ul>
<li>Choose &#34;Connect your own cloud data platform&#34;</li>
</ul>
<p class="image-container"><img alt="Matillion sign up - Choose experience" src="img\\2466f910fc42321a.png"></p>
<h2 is-upgraded>Step 5: Specify credentials (if using your own warehouse)</h2>
<ul>
<li>Provide account, username, and password for your warehouse</li>
<li>You can add additional environments later</li>
</ul>
<p class="image-container"><img alt="Matillion sign up - Warehouse credentials" src="img\\766c470a669ba8b9.png"></p>
<h2 is-upgraded>Step 6: Select warehouse defaults</h2>
<ul>
<li>Set role, warehouse, database, and schema defaults for pipelines</li>
</ul>
<p>You&#39;re now ready to begin building pipelines with Matillion&#39;s code-optional interface, pre-built connectors, Git integration, data sampling, and real-time validation.</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/claat-public/native-shim.js"></script>
  <script src="https://storage.googleapis.com/claat-public/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/claat-public/prettify.js"></script>
  <script src="https://storage.googleapis.com/claat-public/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
